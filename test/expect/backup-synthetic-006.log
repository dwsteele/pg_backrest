run 006 - rmt 1, cmp 0, hardlink 1
==================================

info all stanzas - no stanzas exist (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=warn info
------------------------------------------------------------------------------------------------------------------------------------
No stanzas exist in [TEST_PATH]/backup/repo.

info all stanzas - no stanzas exist (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=warn --output=json info
------------------------------------------------------------------------------------------------------------------------------------
[]

full backup - error on identical link destinations (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=full --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --type=full
 ERROR: [145]: link [TEST_PATH]/db-master/db/base/postgresql.conf (../pg_config) references a subdirectory of or the same directory as link [TEST_PATH]/db-master/db/base/pg_config_bad (../../db/pg_config)
  INFO: backup stop

full backup - error on link to a link (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=full --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --type=full
 ERROR: [145]: link [TEST_PATH]/db-master/db/base/postgresql.conf.bad (../pg_config/postgresql.conf.link) cannot reference another link
  INFO: backup stop

full backup - create pg_stat link, pg_clog dir (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --manifest-save-threshold=3 --type=full --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --manifest-save-threshold=3 --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --type=full
 DEBUG:     Common:::Lock::lockAquire(): bFailOnNoLock = <true>, bRemote = <false>, iProcessIdx = [undef], strLockType = backup
 DEBUG:     Common:::Lock::lockAquire=>: bResult = true
 DEBUG:     Protocol::RemoteMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = [BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote, strHost = db-master, strUser = [USER-1]
 DEBUG:     Protocol::CommonMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = ssh -o LogLevel=error -o Compression=no -o PasswordAuthentication=no vagrant@db-master '[BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote', strId = db-master, strName = remote
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     File->pathCreate(): bCreateParents = true, bIgnoreExists = true, strMode = <0750>, strPath = backup.history, strPathType = backup:cluster
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     Db->info(): oFile = [object], strDbPath = [TEST_PATH]/db-master/db/base
 DEBUG:     Db->info=>: iCatalogVersion = 201306121, iControlVersion = 937, strDbVersion = 9.3, ullDbSysId = 6156904820763115222
 DEBUG:     BackupInfo->check=>: iDbHistoryId = 1
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postmaster.pid, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = [undef], oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [undef], strFilter = [undef], strLevel = [undef], strParentPath = [undef], strPath = [TEST_PATH]/db-master/db/base
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPathType = db:absolute
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = false, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [undef], strLevel = pg_data/pg_stat, strParentPath = [TEST_PATH]/db-master/db/base, strPath = ../pg_stat
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = false, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [undef], strLevel = pg_data/postgresql.conf, strParentPath = [TEST_PATH]/db-master/db/base, strPath = ../pg_config/postgresql.conf
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_config/postgresql.conf, strPathType = db:absolute
 DEBUG:     File->wait(): bWait = false, strPathType = db:absolute
 DEBUG:     Backup->process: create temp backup path [TEST_PATH]/backup/repo/temp/db.tmp
 DEBUG:     File->pathCreate(): bCreateParents = true, bIgnoreExists = false, strMode = <0750>, strPath = [undef], strPathType = backup:tmp
 DEBUG:     Backup->processManifest(): bCompress = false, bHardLink = true, oBackupManifest = [object], strDbPath = [TEST_PATH]/db-master/db/base, strType = full
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/1, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/16384, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/32768, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/global, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_clog, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_stat, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_tblspc, strPathType = backup:tmp
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-1], strDestinationFile = pg_data/postgresql.conf, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/postgresql.conf, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/postgresql.conf (21B, 41%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 21, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-1], strDestinationFile = pg_data/pg_stat/global.stat, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/pg_stat/global.stat, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_stat/global.stat (5B, 50%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 5, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/base/32768/33000, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/base/32768/33000, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/base/32768/33000 (5B, 60%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 5, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/base/16384/17000, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/base/16384/17000, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/base/16384/17000 (4B, 68%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 4, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/base/1/12000, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/base/1/12000, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/base/1/12000 (4B, 76%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 4, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/base/32768/PG_VERSION, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION (3B, 82%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 3, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/base/16384/PG_VERSION, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 3, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/base/1/PG_VERSION, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/base/1/PG_VERSION, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/base/1/PG_VERSION (3B, 94%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 3, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/PG_VERSION, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/PG_VERSION, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/PG_VERSION (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     BackupFile::backupManifestUpdate: save manifest: lManifestSaveCurrent = 3, lManifestSaveSize = 3
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-1], strDestinationFile = pg_data/global/pg_control, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/global/pg_control, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
 DEBUG:     Backup->processManifest=>: lSizeTotal = 8243
  INFO: full backup size = 8KB
  INFO: new backup label = [BACKUP-FULL-1]
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = true, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = <false>, lModificationTime = [undef], strDestinationFile = backup.manifest.gz, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = backup.manifest, strSourcePathType = backup:tmp, strUser = [undef]
 DEBUG:     Backup->process: move [TEST_PATH]/backup/repo/temp/db.tmp to [TEST_PATH]/backup/repo/backup/db/[BACKUP-FULL-1]
 DEBUG:     File->move(): bDestinationPathCreate = <false>, strDestinationFile = [BACKUP-FULL-1], strDestinationPathType = backup:cluster, strSourceFile = [undef], strSourcePathType = backup:tmp
 DEBUG:     File->move(): bDestinationPathCreate = true, strDestinationFile = backup.history/2016/[BACKUP-FULL-1].manifest.gz, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-FULL-1]/backup.manifest.gz, strSourcePathType = backup:cluster
 DEBUG:     File->remove(): bIgnoreMissing = <true>, bTemp = [undef], strPath = latest, strPathType = backup:cluster
 DEBUG:     File->remove=>: bRemoved = false
 DEBUG:     File->linkCreate(): bHard = <false>, bPathCreate = <true>, bRelative = true, strDestinationFile = latest, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-FULL-1], strSourcePathType = backup:cluster
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-1]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     File->list(): bIgnoreMissing = <false>, strExpression = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$, strPath = [undef], strPathType = backup:cluster, strSortOrder = reverse
 DEBUG:     File->list=>: stryFileList = ([BACKUP-FULL-1])
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-1]
 DEBUG:     BackupInfo->current=>: bTest = true
  INFO: archive retention type not set - archive logs will not be expired
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = <true>
 DEBUG:     Exit::exitSafe(): iExitCode = 0, strSignal = [undef]
  INFO: expire stop
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = false

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-FULL-1]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-FULL-1]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="full"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base","type":"path"}
pg_data/pg_stat={"path":"../pg_stat","type":"link"}
pg_data/postgresql.conf={"file":"postgresql.conf","path":"../pg_config","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","size":[SIZE],"timestamp":[TIMESTAMP-2]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_stat={"destination":"../pg_stat"}
pg_data/postgresql.conf={"destination":"../pg_config/postgresql.conf"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-1]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

full backup - resume (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --force --type=full --stanza=db backup --test --test-delay=0.2 --test-point=backup-resume=y
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --force --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --test --test-delay=0.2 --test-point=backup-resume=y --type=full
 DEBUG:     Common:::Lock::lockAquire(): bFailOnNoLock = <true>, bRemote = <false>, iProcessIdx = [undef], strLockType = backup
 DEBUG:     Common:::Lock::lockAquire=>: bResult = true
 DEBUG:     Protocol::RemoteMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = [BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote, strHost = db-master, strUser = [USER-1]
 DEBUG:     Protocol::CommonMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = ssh -o LogLevel=error -o Compression=no -o PasswordAuthentication=no vagrant@db-master '[BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote', strId = db-master, strName = remote
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     File->pathCreate(): bCreateParents = true, bIgnoreExists = true, strMode = <0750>, strPath = backup.history, strPathType = backup:cluster
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
  WARN: backup [BACKUP-FULL-1] missing in repository removed from backup.info
 DEBUG:     BackupInfo->delete(): strBackupLabel = [BACKUP-FULL-1]
 DEBUG:     Db->info(): oFile = [object], strDbPath = [TEST_PATH]/db-master/db/base
 DEBUG:     Db->info=>: iCatalogVersion = 201306121, iControlVersion = 937, strDbVersion = 9.3, ullDbSysId = 6156904820763115222
 DEBUG:     BackupInfo->check=>: iDbHistoryId = 1
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postmaster.pid, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
  WARN: --no-online passed and postmaster.pid exists but --force was passed so backup will continue though it looks like the postmaster is running and the backup will probably not be consistent
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = [undef], oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [undef], strFilter = [undef], strLevel = [undef], strParentPath = [undef], strPath = [TEST_PATH]/db-master/db/base
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPathType = db:absolute
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = false, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [undef], strLevel = pg_data/pg_stat, strParentPath = [TEST_PATH]/db-master/db/base, strPath = ../pg_stat
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = false, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [undef], strLevel = pg_data/postgresql.conf, strParentPath = [TEST_PATH]/db-master/db/base, strPath = ../pg_config/postgresql.conf
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_config/postgresql.conf, strPathType = db:absolute
 DEBUG:     File->wait(): bWait = false, strPathType = db:absolute
  WARN: aborted backup of same type exists, will be cleaned to remove invalid files and resumed
DETAIL: clean backup temp path: [TEST_PATH]/backup/repo/temp/db.tmp
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [undef], strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = pg_data, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/base, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_data/base/1, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_data/base/16384, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_data/base/32768, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/global, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/pg_clog, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/pg_stat, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/pg_tblspc, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     Backup->fileNotInManifest=>: stryFile = (file.tmp, pg_data/PG_VERSION)
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/PG_VERSION
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/file.tmp
 DEBUG:     Backup->processManifest(): bCompress = false, bHardLink = true, oBackupManifest = [object], strDbPath = [TEST_PATH]/db-master/db/base, strType = full
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/1, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/16384, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/32768, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/global, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_clog, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_stat, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_tblspc, strPathType = backup:tmp
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/postgresql.conf, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 21, strHash = 6721d92c9fcdf4248acff1f9a1377127d9064807
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/postgresql.conf (21B, 41%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/pg_stat/global.stat, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 5, strHash = e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/pg_stat/global.stat (5B, 50%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/base/32768/33000, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 5, strHash = 7f4c74dc10f61eef43e6ae642606627df1999b34
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/base/32768/33000 (5B, 60%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/base/16384/17000, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 4, strHash = a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/base/16384/17000 (4B, 68%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/base/1/12000, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 4, strHash = a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/base/1/12000 (4B, 76%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/base/32768/PG_VERSION, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION (3B, 82%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/base/16384/PG_VERSION, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/base/1/PG_VERSION, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/base/1/PG_VERSION (3B, 94%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/PG_VERSION, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/PG_VERSION, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/PG_VERSION (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/global/pg_control, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 8192, strHash = 56fe5780b8dca9705e0c22032a83828860a21235
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
 DEBUG:     Backup->processManifest=>: lSizeTotal = 8243
  INFO: full backup size = 8KB
  INFO: new backup label = [BACKUP-FULL-2]
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = true, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = <false>, lModificationTime = [undef], strDestinationFile = backup.manifest.gz, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = backup.manifest, strSourcePathType = backup:tmp, strUser = [undef]
 DEBUG:     Backup->process: move [TEST_PATH]/backup/repo/temp/db.tmp to [TEST_PATH]/backup/repo/backup/db/[BACKUP-FULL-2]
 DEBUG:     File->move(): bDestinationPathCreate = <false>, strDestinationFile = [BACKUP-FULL-2], strDestinationPathType = backup:cluster, strSourceFile = [undef], strSourcePathType = backup:tmp
 DEBUG:     File->move(): bDestinationPathCreate = true, strDestinationFile = backup.history/2016/[BACKUP-FULL-2].manifest.gz, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-FULL-2]/backup.manifest.gz, strSourcePathType = backup:cluster
 DEBUG:     File->remove(): bIgnoreMissing = <true>, bTemp = [undef], strPath = latest, strPathType = backup:cluster
 DEBUG:     File->remove=>: bRemoved = true
 DEBUG:     File->linkCreate(): bHard = <false>, bPathCreate = <true>, bRelative = true, strDestinationFile = latest, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-FULL-2], strSourcePathType = backup:cluster
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     File->list(): bIgnoreMissing = <false>, strExpression = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$, strPath = [undef], strPathType = backup:cluster, strSortOrder = reverse
 DEBUG:     File->list=>: stryFileList = ([BACKUP-FULL-2])
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
  INFO: archive retention type not set - archive logs will not be expired
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = <true>
 DEBUG:     Exit::exitSafe(): iExitCode = 0, strSignal = [undef]
  INFO: expire stop
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = false

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-FULL-2]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="full"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base","type":"path"}
pg_data/pg_stat={"path":"../pg_stat","type":"link"}
pg_data/postgresql.conf={"file":"postgresql.conf","path":"../pg_config","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","size":[SIZE],"timestamp":[TIMESTAMP-2]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_stat={"destination":"../pg_stat"}
pg_data/postgresql.conf={"destination":"../pg_config/postgresql.conf"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

restore delta, backup '[BACKUP-FULL-2]' - add and delete files (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --set=[BACKUP-FULL-2]  --link-all  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --delta --link-all --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-FULL-2] --stanza=db
 DEBUG:     Common:::Lock::lockAquire(): bFailOnNoLock = <true>, bRemote = <false>, iProcessIdx = [undef], strLockType = restore
 DEBUG:     Common:::Lock::lockAquire=>: bResult = true
 DEBUG:     Protocol::RemoteMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = [BACKREST-BIN] --backup-host=backup --command=restore --config=[TEST_PATH]/backup/pgbackrest.conf --repo-path=[TEST_PATH]/backup/repo --stanza=db remote, strHost = backup, strUser = [USER-2]
 DEBUG:     Protocol::CommonMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = ssh -o LogLevel=error -o Compression=no -o PasswordAuthentication=no backrest@backup '[BACKREST-BIN] --backup-host=backup --command=restore --config=[TEST_PATH]/backup/pgbackrest.conf --repo-path=[TEST_PATH]/backup/repo --stanza=db remote', strId = backup, strName = remote
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = backup, strStanza = db
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postmaster.pid, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/PG_VERSION, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = <false>, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = <false>, lModificationTime = [undef], strDestinationFile = [TEST_PATH]/db-master/db/base/backup.info, strDestinationPathType = db:absolute, strGroup = [undef], strMode = <0640>, strSourceFile = backup.info, strSourcePathType = backup:cluster, strUser = [undef]
 DEBUG:     BackupInfo->new(): bValidate = false, strBackupClusterPath = [TEST_PATH]/db-master/db/base
 DEBUG:     File->remove(): bIgnoreMissing = false, bTemp = [undef], strPath = [TEST_PATH]/db-master/db/base/backup.info, strPathType = db:absolute
 DEBUG:     File->remove=>: bRemoved = true
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
  INFO: restore backup set [BACKUP-FULL-2]
 DEBUG:     File->exists(): strPath = [BACKUP-FULL-2], strPathType = backup:cluster
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = <false>, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = <false>, lModificationTime = [undef], strDestinationFile = [TEST_PATH]/db-master/db/base/backup.manifest, strDestinationPathType = db:absolute, strGroup = [undef], strMode = <0640>, strSourceFile = [BACKUP-FULL-2]/backup.manifest, strSourcePathType = backup:cluster, strUser = [undef]
 DEBUG:     Restore->manifestOwnershipCheck(): oManifest = [object]
 DEBUG:     File->remove(): bIgnoreMissing = <true>, bTemp = [undef], strPath = [TEST_PATH]/db-master/db/base/global/pg_control, strPathType = db:absolute
 DEBUG:     File->remove=>: bRemoved = true
 DEBUG:     Restore->clean(): oManifest = [object]
DETAIL: check [TEST_PATH]/db-master/db/base exists
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = base, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = base/1, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = base/16384, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = base/32768, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = deleteme, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = global, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = pg_tblspc, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
DETAIL: check [TEST_PATH]/db-master/db/pg_stat exists
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
DETAIL: check [TEST_PATH]/db-master/db/pg_config exists
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_config, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_config/postgresql.conf, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/pg_config
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_config, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_config, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/db-master/db/pg_config, strPathType = db:absolute
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/pg_stat
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/base
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = base, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = base/1, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = base/16384, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = base/32768, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = deleteme, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = global, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = pg_tblspc, strPathOp = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
DETAIL: remove file [TEST_PATH]/db-master/db/base/recovery.done
DETAIL: preserve file [TEST_PATH]/db-master/db/base/recovery.conf
DETAIL: remove file [TEST_PATH]/db-master/db/base/deleteme/deleteme.txt
DETAIL: remove path [TEST_PATH]/db-master/db/base/deleteme
DETAIL: set mode 0700 on [TEST_PATH]/db-master/db/base/base
DETAIL: remove file [TEST_PATH]/db-master/db/base/backup_label.old
  INFO: cleanup removed 3 files, 1 path
 DEBUG:     Restore->build(): oManifest = [object]
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_stat, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/pg_config, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     build level 1 paths/links
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/global, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/pg_clog, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = 0700, strPath = [TEST_PATH]/db-master/db/base/pg_clog, strPathType = db:absolute
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/pg_stat, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postgresql.conf, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     build level 2 paths/links
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/1, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/16384, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/32768, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     build level 3 paths/links
 DEBUG:     Restore->process: restore in main process
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postgresql.conf, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/postgresql.conf, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 21, strHash = 6721d92c9fcdf4248acff1f9a1377127d9064807
DETAIL: restore file [TEST_PATH]/db-master/db/base/postgresql.conf - exists and matches backup (21B, 41%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/pg_stat/global.stat, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/pg_stat/global.stat, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 5, strHash = e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
DETAIL: restore file [TEST_PATH]/db-master/db/base/pg_stat/global.stat - exists and matches backup (5B, 50%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/32768/33000, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/base/32768/33000, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 5, strHash = 7f4c74dc10f61eef43e6ae642606627df1999b34
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/32768/33000 - exists and matches backup (5B, 60%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/16384/17000, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = <false>, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = [TEST_PATH]/db-master/db/base/base/16384/17000, strDestinationPathType = db:absolute, strGroup = [GROUP-1], strMode = 0600, strSourceFile = [BACKUP-FULL-2]/pg_data/base/16384/17000, strSourcePathType = backup:cluster, strUser = [USER-1]
 DEBUG:     File->owner(): strFile = [TEST_PATH]/db-master/db/base/base/16384/17000.backrest.tmp, strGroup = [GROUP-1], strPathType = absolute, strUser = [USER-1]
  INFO: restore file [TEST_PATH]/db-master/db/base/base/16384/17000 (4B, 68%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/1/12000, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/base/1/12000, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 4, strHash = a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/1/12000 - exists and matches backup (4B, 76%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION - exists and matches backup (3B, 82%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION - exists and matches backup (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/base/1/PG_VERSION, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/base/1/PG_VERSION, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/1/PG_VERSION - exists and matches backup (3B, 94%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/PG_VERSION, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->hashSize(): bCompressed = <false>, strFile = [TEST_PATH]/db-master/db/base/PG_VERSION, strHashType = <sha1>, strPathType = db:absolute
 DEBUG:     File->hashSize=>: iSize = 3, strHash = e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/PG_VERSION - exists and matches backup (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/recovery.conf, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = true
 DEBUG:     File->remove(): bIgnoreMissing = <true>, bTemp = [undef], strPath = [TEST_PATH]/db-master/db/base/recovery.conf, strPathType = db:absolute
 DEBUG:     File->remove=>: bRemoved = true
  INFO: wrote [TEST_PATH]/db-master/db/base/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/global/pg_control, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = <false>, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-1], strDestinationFile = [TEST_PATH]/db-master/db/base/global/pg_control, strDestinationPathType = db:absolute, strGroup = [GROUP-1], strMode = 0600, strSourceFile = [BACKUP-FULL-2]/pg_data/global/pg_control, strSourcePathType = backup:cluster, strUser = [USER-1]
 DEBUG:     File->owner(): strFile = [TEST_PATH]/db-master/db/base/global/pg_control.backrest.tmp, strGroup = [GROUP-1], strPathType = absolute, strUser = [USER-1]
  INFO: restore file [TEST_PATH]/db-master/db/base/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
 DEBUG:     File->remove(): bIgnoreMissing = false, bTemp = [undef], strPath = [TEST_PATH]/db-master/db/base/backup.manifest, strPathType = db:absolute
 DEBUG:     File->remove=>: bRemoved = true
 DEBUG:     Exit::exitSafe(): iExitCode = 0, strSignal = [undef]
  INFO: restore stop
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = false

+ supplemental file: [TEST_PATH]/db-master/db/base/recovery.conf
----------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --stanza=db archive-get %f "%p"'

restore delta, backup '[BACKUP-FULL-2]' - fix broken symlink (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --set=[BACKUP-FULL-2]  --link-all --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --delta --link-all --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-FULL-2] --stanza=db
  INFO: restore backup set [BACKUP-FULL-2]
DETAIL: check [TEST_PATH]/db-master/db/base exists
DETAIL: check [TEST_PATH]/db-master/db/pg_stat exists
DETAIL: check [TEST_PATH]/db-master/db/pg_config exists
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/pg_config
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/pg_stat
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/base
DETAIL: preserve file [TEST_PATH]/db-master/db/base/recovery.conf
DETAIL: remove link [TEST_PATH]/db-master/db/base/pg_stat - destination changed
DETAIL: restore file [TEST_PATH]/db-master/db/base/postgresql.conf - exists and matches backup (21B, 41%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
DETAIL: restore file [TEST_PATH]/db-master/db/base/pg_stat/global.stat - exists and matches backup (5B, 50%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/32768/33000 - exists and matches backup (5B, 60%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/16384/17000 - exists and matches backup (4B, 68%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/1/12000 - exists and matches backup (4B, 76%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION - exists and matches backup (3B, 82%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION - exists and matches backup (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/1/PG_VERSION - exists and matches backup (3B, 94%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/PG_VERSION - exists and matches backup (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base/recovery.conf
----------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

restore delta, force, backup '[BACKUP-FULL-2]', expect exit 115 - fail on missing PG_VERSION (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --force --set=[BACKUP-FULL-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --delta --force --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-FULL-2] --stanza=db
  WARN: --delta or --force specified but unable to find 'PG_VERSION' or 'backup.manifest' in '[TEST_PATH]/db-master/db/base' to confirm that this is a valid $PGDATA directory.  --delta and --force have been disabled and if any files exist in the destination directories the restore will be aborted.
  INFO: restore backup set [BACKUP-FULL-2]
  WARN: contents of directory link pg_stat will be restored in a directory at the same location
  WARN: file link postgresql.conf will be restored as a file at the same location
DETAIL: check [TEST_PATH]/db-master/db/base exists
 ERROR: [115]: cannot restore to path '[TEST_PATH]/db-master/db/base' that contains files - try using --delta if this is what you intended
  INFO: restore stop

restore delta, force, backup '[BACKUP-FULL-2]' - restore succeeds with backup.manifest file (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --force --set=[BACKUP-FULL-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --delta --force --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-FULL-2] --stanza=db
  INFO: restore backup set [BACKUP-FULL-2]
  WARN: group bogus in manifest cannot be used for restore, set to postgres
  WARN: user bogus in manifest cannot be used for restore, set to vagrant
  WARN: contents of directory link pg_stat will be restored in a directory at the same location
  WARN: file link postgresql.conf will be restored as a file at the same location
DETAIL: check [TEST_PATH]/db-master/db/base exists
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/base
DETAIL: preserve file [TEST_PATH]/db-master/db/base/recovery.conf
DETAIL: remove link [TEST_PATH]/db-master/db/base/postgresql.conf
DETAIL: remove link [TEST_PATH]/db-master/db/base/pg_stat
  INFO: cleanup removed 2 links
  INFO: restore file [TEST_PATH]/db-master/db/base/postgresql.conf (21B, 41%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
  INFO: restore file [TEST_PATH]/db-master/db/base/pg_stat/global.stat (5B, 50%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/32768/33000 - exists and matches size 5 and modification time [MODIFICATION-TIME-2] (5B, 60%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/16384/17000 - exists and matches size 4 and modification time [MODIFICATION-TIME-2] (4B, 68%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/1/12000 - exists and matches size 4 and modification time [MODIFICATION-TIME-2] (4B, 76%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/32768/PG_VERSION - exists and matches size 3 and modification time [MODIFICATION-TIME-2] (3B, 82%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/16384/PG_VERSION - exists and matches size 3 and modification time [MODIFICATION-TIME-2] (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base/base/1/PG_VERSION - exists and matches size 3 and modification time [MODIFICATION-TIME-2] (3B, 94%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base/PG_VERSION (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base/recovery.conf
----------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

incr backup - invalid database version (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [126]: database version = 9.3, system-id 6156904820763115222 does not match backup version = 8.0, system-id = 6156904820763115222
               HINT: is this the correct stanza?
  INFO: backup stop

incr backup - invalid system id (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [126]: database version = 9.3, system-id 6156904820763115222 does not match backup version = 9.3, system-id = 6999999999999999999
               HINT: is this the correct stanza?
  INFO: backup stop

incr backup - invalid control version (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [126]: database control-version = 937, catalog-version 201306121 does not match backup control-version = 842, catalog-version = 201306121
               HINT: this may be a symptom of database or repository corruption!
  INFO: backup stop

incr backup - invalid catalog version (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [126]: database control-version = 937, catalog-version 201306121 does not match backup control-version = 937, catalog-version = 197208141
               HINT: this may be a symptom of database or repository corruption!
  INFO: backup stop

incr backup - invalid path in pg_tblspc (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [144]: pg_tblspc/path is not a symlink - pg_tblspc should contain only symlinks
  INFO: backup stop

incr backup - invalid relative tablespace in $PGDATA (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [146]: tablespace symlink ../invalid_tblspc destination must not be in $PGDATA
  INFO: backup stop

incr backup - invalid tablespace in $PGDATA (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 ERROR: [146]: tablespace symlink [TEST_PATH]/db-master/db/base/invalid_tblspc destination must not be in $PGDATA
  INFO: backup stop

incr backup - add tablespace 1 (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --test --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --test
 DEBUG:     Common:::Lock::lockAquire(): bFailOnNoLock = <true>, bRemote = <false>, iProcessIdx = [undef], strLockType = backup
 DEBUG:     Common:::Lock::lockAquire=>: bResult = true
 DEBUG:     Protocol::RemoteMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = [BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote, strHost = db-master, strUser = [USER-1]
 DEBUG:     Protocol::CommonMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = ssh -o LogLevel=error -o Compression=no -o PasswordAuthentication=no vagrant@db-master '[BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote', strId = db-master, strName = remote
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     File->pathCreate(): bCreateParents = true, bIgnoreExists = true, strMode = <0750>, strPath = backup.history, strPathType = backup:cluster
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupInfo->last(): strType = incr
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->list(): strFilter = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$, strOrder = reverse
 DEBUG:     BackupInfo->list=>: stryBackup = ([BACKUP-FULL-2])
 DEBUG:     BackupInfo->last=>: strBackup = [BACKUP-FULL-2]
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 DEBUG:     Db->info(): oFile = [object], strDbPath = [TEST_PATH]/db-master/db/base
 DEBUG:     Db->info=>: iCatalogVersion = 201306121, iControlVersion = 937, strDbVersion = 9.3, ullDbSysId = 6156904820763115222
 DEBUG:     BackupInfo->check=>: iDbHistoryId = 1
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postmaster.pid, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = [undef], oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [object], oTablespaceMapRef = [undef], strFilter = [undef], strLevel = [undef], strParentPath = [undef], strPath = [TEST_PATH]/db-master/db/base
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPathType = db:absolute
 DEBUG:     Manifest->build: found tablespace 1
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = true, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [TS_PATH-1], strLevel = pg_tblspc/1, strParentPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPath = [TEST_PATH]/db-master/db/tablespace/ts1
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/tablespace/ts1, strPathType = db:absolute
 DEBUG:     File->wait(): bWait = false, strPathType = db:absolute
 DEBUG:     Backup->process: create temp backup path [TEST_PATH]/backup/repo/temp/db.tmp
 DEBUG:     File->pathCreate(): bCreateParents = true, bIgnoreExists = false, strMode = <0750>, strPath = [undef], strPathType = backup:tmp
 DEBUG:     Backup->processManifest(): bCompress = false, bHardLink = true, oBackupManifest = [object], strDbPath = [TEST_PATH]/db-master/db/base, strType = incr
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/1, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/16384, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/32768, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/global, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_clog, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_stat, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_tblspc, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/1, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/1/[TS_PATH-1], strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/1/[TS_PATH-1]/16384, strPathType = backup:tmp
 DEBUG:     Backup->processManifest: hardlink pg_data/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/1/12000 to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/1/12000, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/1/12000, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/1/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/1/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/1/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/16384/17000 to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/16384/17000, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/16384/17000, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/16384/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/16384/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/16384/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/32768/33000 to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/32768/33000, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/32768/33000, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/32768/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/32768/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/32768/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/global/pg_control to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/global/pg_control, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/global/pg_control, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/pg_stat/global.stat to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/pg_stat/global.stat, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/pg_stat/global.stat, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/postgresql.conf to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/postgresql.conf, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/postgresql.conf, strSourcePathType = backup:cluster
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/badchecksum.txt, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/badchecksum.txt, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/badchecksum.txt (11B, 61%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt (7B, 100%) checksum d85de07d6421d90aa9191c11c889bfde43680f0f
 DEBUG:     Backup->processManifest=>: lSizeTotal = 18
  INFO: incr backup size = 18B
  INFO: new backup label = [BACKUP-INCR-1]
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = true, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = <false>, lModificationTime = [undef], strDestinationFile = backup.manifest.gz, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = backup.manifest, strSourcePathType = backup:tmp, strUser = [undef]
 DEBUG:     Backup->process: move [TEST_PATH]/backup/repo/temp/db.tmp to [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-1]
 DEBUG:     File->move(): bDestinationPathCreate = <false>, strDestinationFile = [BACKUP-INCR-1], strDestinationPathType = backup:cluster, strSourceFile = [undef], strSourcePathType = backup:tmp
 DEBUG:     File->move(): bDestinationPathCreate = true, strDestinationFile = backup.history/2016/[BACKUP-INCR-1].manifest.gz, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-INCR-1]/backup.manifest.gz, strSourcePathType = backup:cluster
 DEBUG:     File->remove(): bIgnoreMissing = <true>, bTemp = [undef], strPath = latest, strPathType = backup:cluster
 DEBUG:     File->remove=>: bRemoved = true
 DEBUG:     File->linkCreate(): bHard = <false>, bPathCreate = <true>, bRelative = true, strDestinationFile = latest, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-INCR-1], strSourcePathType = backup:cluster
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-INCR-1]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     File->list(): bIgnoreMissing = <false>, strExpression = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$, strPath = [undef], strPathType = backup:cluster, strSortOrder = reverse
 DEBUG:     File->list=>: stryFileList = ([BACKUP-INCR-1], [BACKUP-FULL-2])
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-INCR-1]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
  INFO: archive retention type not set - archive logs will not be expired
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = <true>
 DEBUG:     Exit::exitSafe(): iExitCode = 0, strSignal = [undef]
  INFO: expire stop
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = false

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-1]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-INCR-1]"
backup-prior="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="incr"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base","type":"path"}
pg_tblspc/1={"path":"[TEST_PATH]/db-master/db/tablespace/ts1","tablespace-id":"1","tablespace-name":"ts1","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt={"checksum":"d85de07d6421d90aa9191c11c889bfde43680f0f","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/1={"destination":"[TEST_PATH]/db-master/db/tablespace/ts1"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/1={}
pg_tblspc/1/[TS_PATH-1]={}
pg_tblspc/1/[TS_PATH-1]/16384={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-1]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

incr backup - resume and add tablespace 2 (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --stanza=db backup --test --test-delay=0.2 --test-point=backup-resume=y
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --test --test-delay=0.2 --test-point=backup-resume=y
 DEBUG:     Common:::Lock::lockAquire(): bFailOnNoLock = <true>, bRemote = <false>, iProcessIdx = [undef], strLockType = backup
 DEBUG:     Common:::Lock::lockAquire=>: bResult = true
 DEBUG:     Protocol::RemoteMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = [BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote, strHost = db-master, strUser = [USER-1]
 DEBUG:     Protocol::CommonMaster->new(): iBufferMax = 4194304, iCompressLevel = 6, iCompressLevelNetwork = 3, iProtocolTimeout = 1830, strCommand = ssh -o LogLevel=error -o Compression=no -o PasswordAuthentication=no vagrant@db-master '[BACKREST-BIN] --command=backup --config=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --repo-path=[TEST_PATH]/backup/repo --stanza=db remote', strId = db-master, strName = remote
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     File->pathCreate(): bCreateParents = true, bIgnoreExists = true, strMode = <0750>, strPath = backup.history, strPathType = backup:cluster
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
  WARN: backup [BACKUP-INCR-1] missing in repository removed from backup.info
 DEBUG:     BackupInfo->delete(): strBackupLabel = [BACKUP-INCR-1]
 DEBUG:     BackupInfo->last(): strType = incr
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->list(): strFilter = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$, strOrder = reverse
 DEBUG:     BackupInfo->list=>: stryBackup = ([BACKUP-FULL-2])
 DEBUG:     BackupInfo->last=>: strBackup = [BACKUP-FULL-2]
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
 DEBUG:     Db->info(): oFile = [object], strDbPath = [TEST_PATH]/db-master/db/base
 DEBUG:     Db->info=>: iCatalogVersion = 201306121, iControlVersion = 937, strDbVersion = 9.3, ullDbSysId = 6156904820763115222
 DEBUG:     BackupInfo->check=>: iDbHistoryId = 1
 DEBUG:     File->exists(): strPath = [TEST_PATH]/db-master/db/base/postmaster.pid, strPathType = db:absolute
 DEBUG:     File->exists=>: bExists = false
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = [undef], oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [object], oTablespaceMapRef = [undef], strFilter = [undef], strLevel = [undef], strParentPath = [undef], strPath = [TEST_PATH]/db-master/db/base
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPathType = db:absolute
 DEBUG:     Manifest->build: found tablespace 1
 DEBUG:     Manifest->build: found tablespace 2
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/base, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = true, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [TS_PATH-1], strLevel = pg_tblspc/1, strParentPath = [TEST_PATH]/db-master/db/base/pg_tblspc, strPath = [TEST_PATH]/db-master/db/tablespace/ts1
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/tablespace/ts1, strPathType = db:absolute
 DEBUG:     Manifest->build(): bOnline = false, bTablespace = true, oDatabaseMapRef = [undef], oFile = [object], oLastManifest = [undef], oTablespaceMapRef = [hash], strFilter = [TS_PATH-1], strLevel = pg_tblspc/2, strParentPath = [TEST_PATH]/db-master/db/base/pg_tblspc/pg_tblspc, strPath = [TEST_PATH]/db-master/db/tablespace/ts2
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [TEST_PATH]/db-master/db/tablespace/ts2, strPathType = db:absolute
 DEBUG:     File->wait(): bWait = false, strPathType = db:absolute
  WARN: aborted backup of same type exists, will be cleaned to remove invalid files and resumed
DETAIL: clean backup temp path: [TEST_PATH]/backup/repo/temp/db.tmp
 DEBUG:     File->manifest(): oManifestHashRef = [hash], strPath = [undef], strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 0, oManifestHashRef = [hash], strPathFileOp = [undef], strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = pg_data, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/base, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_data/base/1, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_data/base/16384, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_data/base/32768, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/global, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/pg_clog, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/pg_stat, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_data/pg_tblspc, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 1, oManifestHashRef = [hash], strPathFileOp = pg_tblspc, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 2, oManifestHashRef = [hash], strPathFileOp = pg_tblspc/1, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 3, oManifestHashRef = [hash], strPathFileOp = pg_tblspc/1/[TS_PATH-1], strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     File->manifestRecurse(): iDepth = 4, oManifestHashRef = [hash], strPathFileOp = pg_tblspc/1/[TS_PATH-1]/16384, strPathOp = [TEST_PATH]/backup/repo/temp/db.tmp, strPathType = backup:tmp
 DEBUG:     Backup->fileNotInManifest=>: stryFile = (pg_data/PG_VERSION, pg_data/base/1/12000, pg_data/base/1/PG_VERSION, pg_data/base/16384/17000, pg_data/base/16384/PG_VERSION, pg_data/base/32768/33000, pg_data/base/32768/PG_VERSION, pg_data/global/pg_control, pg_data/pg_stat/global.stat, pg_data/postgresql.conf)
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/postgresql.conf
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/pg_stat/global.stat
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/global/pg_control
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/base/32768/PG_VERSION
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/base/32768/33000
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/base/16384/PG_VERSION
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/base/16384/17000
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/base/1/PG_VERSION
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/base/1/12000
 DEBUG:     Backup->tmpClean: remove file [TEST_PATH]/backup/repo/temp/db.tmp/pg_data/PG_VERSION
 DEBUG:     Backup->processManifest(): bCompress = false, bHardLink = true, oBackupManifest = [object], strDbPath = [TEST_PATH]/db-master/db/base, strType = incr
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/1, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/16384, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/base/32768, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/global, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_clog, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_stat, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_data/pg_tblspc, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/1, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/1/[TS_PATH-1], strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/1/[TS_PATH-1]/16384, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/2, strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/2/[TS_PATH-1], strPathType = backup:tmp
 DEBUG:     File->pathCreate(): bCreateParents = <false>, bIgnoreExists = <false>, strMode = <0750>, strPath = pg_tblspc/2/[TS_PATH-1]/32768, strPathType = backup:tmp
 DEBUG:     Backup->processManifest: hardlink pg_data/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/1/12000 to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/1/12000, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/1/12000, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/1/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/1/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/1/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/16384/17000 to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/16384/17000, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/16384/17000, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/16384/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/16384/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/16384/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/32768/33000 to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/32768/33000, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/32768/33000, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/base/32768/PG_VERSION to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/base/32768/PG_VERSION, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/base/32768/PG_VERSION, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/global/pg_control to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/global/pg_control, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/global/pg_control, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/pg_stat/global.stat to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/pg_stat/global.stat, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/pg_stat/global.stat, strSourcePathType = backup:cluster
 DEBUG:     Backup->processManifest: hardlink pg_data/postgresql.conf to [BACKUP-FULL-2]
 DEBUG:     File->linkCreate(): bHard = true, bPathCreate = true, bRelative = false, strDestinationFile = pg_data/postgresql.conf, strDestinationPathType = backup:tmp, strSourceFile = [BACKUP-FULL-2]/pg_data/postgresql.conf, strSourcePathType = backup:cluster
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_data/badchecksum.txt, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 11, strHash = f927212cd08d11a42a666b2f04235398e9ceeb51
  WARN: resumed backup file pg_data/badchecksum.txt should have checksum bogus but actually has checksum f927212cd08d11a42a666b2f04235398e9ceeb51.  The file will be recopied and backup will continue but this may be an issue unless the backup temp path is known to be corrupted.
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_data/badchecksum.txt, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/badchecksum.txt, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/badchecksum.txt (11B, 44%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = false, bDestinationPathCreate = true, bIgnoreMissingSource = true, bSourceCompressed = false, lModificationTime = [MODIFICATION-TIME-2], strDestinationFile = pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = [TEST_PATH]/db-master/db/base/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt, strSourcePathType = db:absolute, strUser = [undef]
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 72%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
 DEBUG:     File->hashSize(): bCompressed = false, strFile = pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt, strHashType = <sha1>, strPathType = backup:tmp
 DEBUG:     File->hashSize=>: iSize = 7, strHash = d85de07d6421d90aa9191c11c889bfde43680f0f
DETAIL: checksum resumed file [TEST_PATH]/db-master/db/base/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt (7B, 100%) checksum d85de07d6421d90aa9191c11c889bfde43680f0f
 DEBUG:     Backup->processManifest=>: lSizeTotal = 25
  INFO: incr backup size = 25B
  INFO: new backup label = [BACKUP-INCR-2]
 DEBUG:     File->copy(): bAppendChecksum = <false>, bDestinationCompress = true, bDestinationPathCreate = <false>, bIgnoreMissingSource = <false>, bSourceCompressed = <false>, lModificationTime = [undef], strDestinationFile = backup.manifest.gz, strDestinationPathType = backup:tmp, strGroup = [undef], strMode = <0640>, strSourceFile = backup.manifest, strSourcePathType = backup:tmp, strUser = [undef]
 DEBUG:     Backup->process: move [TEST_PATH]/backup/repo/temp/db.tmp to [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-2]
 DEBUG:     File->move(): bDestinationPathCreate = <false>, strDestinationFile = [BACKUP-INCR-2], strDestinationPathType = backup:cluster, strSourceFile = [undef], strSourcePathType = backup:tmp
 DEBUG:     File->move(): bDestinationPathCreate = true, strDestinationFile = backup.history/2016/[BACKUP-INCR-2].manifest.gz, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-INCR-2]/backup.manifest.gz, strSourcePathType = backup:cluster
 DEBUG:     File->remove(): bIgnoreMissing = <true>, bTemp = [undef], strPath = latest, strPathType = backup:cluster
 DEBUG:     File->remove=>: bRemoved = true
 DEBUG:     File->linkCreate(): bHard = <false>, bPathCreate = <true>, bRelative = true, strDestinationFile = latest, strDestinationPathType = backup:cluster, strSourceFile = [BACKUP-INCR-2], strSourcePathType = backup:cluster
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=debug --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
 DEBUG:     File->new(): iThreadIdx = [undef], oProtocol = [object], strBackupPath = [TEST_PATH]/backup/repo, strDefaultFileMode = <0640>, strDefaultPathMode = <0750>, strRemote = db, strStanza = db
 DEBUG:     BackupInfo->new(): bValidate = <true>, strBackupClusterPath = [TEST_PATH]/backup/repo/backup/db
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-INCR-2]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupCommon::backupRegExpGet(): bAnchor = <true>, bDifferential = true, bFull = true, bIncremental = true
 DEBUG:     BackupCommon::backupRegExpGet=>: strRegExp = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$
 DEBUG:     File->list(): bIgnoreMissing = <false>, strExpression = ^[0-9]{8}\-[0-9]{6}F(\_[0-9]{8}\-[0-9]{6}(D|I)){0,1}$, strPath = [undef], strPathType = backup:cluster, strSortOrder = reverse
 DEBUG:     File->list=>: stryFileList = ([BACKUP-INCR-2], [BACKUP-FULL-2])
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-INCR-2]
 DEBUG:     BackupInfo->current=>: bTest = true
 DEBUG:     BackupInfo->current(): strBackup = [BACKUP-FULL-2]
 DEBUG:     BackupInfo->current=>: bTest = true
  INFO: archive retention type not set - archive logs will not be expired
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = <true>
 DEBUG:     Exit::exitSafe(): iExitCode = 0, strSignal = [undef]
  INFO: expire stop
 DEBUG:     Common:::Lock::lockRelease(): bFailOnNoLock = false

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-2]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-INCR-2]"
backup-prior="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="incr"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base","type":"path"}
pg_tblspc/1={"path":"[TEST_PATH]/db-master/db/tablespace/ts1","tablespace-id":"1","tablespace-name":"ts1","type":"link"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt={"checksum":"d85de07d6421d90aa9191c11c889bfde43680f0f","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/1={"destination":"[TEST_PATH]/db-master/db/tablespace/ts1"}
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/1={}
pg_tblspc/1/[TS_PATH-1]={}
pg_tblspc/1/[TS_PATH-1]/16384={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

diff backup - cannot resume - new diff (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=diff --stanza=db backup --test --test-delay=0.2 --test-point=backup-noresume=y
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --test --test-delay=0.2 --test-point=backup-noresume=y --type=diff
  WARN: backup [BACKUP-INCR-2] missing in repository removed from backup.info
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
  WARN: aborted backup exists, but cannot be resumed (new backup-type 'diff' does not match aborted backup-type 'incr') - will be dropped and recreated
  INFO: backup file [TEST_PATH]/db-master/db/base/badchecksum.txt (11B, 44%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 72%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt (7B, 100%) checksum d85de07d6421d90aa9191c11c889bfde43680f0f
  INFO: diff backup size = 25B
  INFO: new backup label = [BACKUP-DIFF-1]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-DIFF-1]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-DIFF-1]"
backup-prior="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="diff"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base","type":"path"}
pg_tblspc/1={"path":"[TEST_PATH]/db-master/db/tablespace/ts1","tablespace-id":"1","tablespace-name":"ts1","type":"link"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt={"checksum":"d85de07d6421d90aa9191c11c889bfde43680f0f","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/1={"destination":"[TEST_PATH]/db-master/db/tablespace/ts1"}
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/1={}
pg_tblspc/1/[TS_PATH-1]={}
pg_tblspc/1/[TS_PATH-1]/16384={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-1]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

diff backup - cannot resume - disabled (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --no-resume --log-level-console=detail --type=diff --stanza=db backup --test --test-delay=0.2 --test-point=backup-noresume=y
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --no-resume --stanza=db --start-fast --test --test-delay=0.2 --test-point=backup-noresume=y --type=diff
  WARN: backup [BACKUP-DIFF-1] missing in repository removed from backup.info
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
  WARN: aborted backup exists, but cannot be resumed (resume is disabled) - will be dropped and recreated
  INFO: backup file [TEST_PATH]/db-master/db/base/badchecksum.txt (11B, 44%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 72%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
  INFO: backup file [TEST_PATH]/db-master/db/base/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt (7B, 100%) checksum d85de07d6421d90aa9191c11c889bfde43680f0f
  INFO: diff backup size = 25B
  INFO: new backup label = [BACKUP-DIFF-2]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-DIFF-2]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-DIFF-2]"
backup-prior="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="diff"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base","type":"path"}
pg_tblspc/1={"path":"[TEST_PATH]/db-master/db/tablespace/ts1","tablespace-id":"1","tablespace-name":"ts1","type":"link"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt={"checksum":"d85de07d6421d90aa9191c11c889bfde43680f0f","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/1={"destination":"[TEST_PATH]/db-master/db/tablespace/ts1"}
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/1={}
pg_tblspc/1/[TS_PATH-1]={}
pg_tblspc/1/[TS_PATH-1]/16384={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

restore, backup '[BACKUP-DIFF-2]', expect exit 115 - fail on used path (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --set=[BACKUP-DIFF-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-DIFF-2] --stanza=db
  INFO: restore backup set [BACKUP-DIFF-2]
DETAIL: check [TEST_PATH]/db-master/db/base exists
 ERROR: [115]: cannot restore to path '[TEST_PATH]/db-master/db/base' that contains files - try using --delta if this is what you intended
  INFO: restore stop

restore, backup '[BACKUP-DIFF-2]', expect exit 104 - fail on undef format (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --set=[BACKUP-DIFF-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-DIFF-2] --stanza=db
  INFO: restore backup set [BACKUP-DIFF-2]
 ERROR: [104]: format of [TEST_PATH]/db-master/db/base/backup.manifest is 0 but 5 is required
  INFO: restore stop

restore, backup '[BACKUP-DIFF-2]', expect exit 104 - fail on mismatch format (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --set=[BACKUP-DIFF-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-DIFF-2] --stanza=db
  INFO: restore backup set [BACKUP-DIFF-2]
 ERROR: [104]: format of [TEST_PATH]/db-master/db/base/backup.manifest is 0 but 5 is required
  INFO: restore stop

restore, backup '[BACKUP-DIFF-2]', remap - remap all paths (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --set=[BACKUP-DIFF-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base-2 --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-DIFF-2] --stanza=db --tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2 --tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2
  INFO: restore backup set [BACKUP-DIFF-2]
  INFO: remap $PGDATA directory to [TEST_PATH]/db-master/db/base-2
  INFO: remap tablespace pg_tblspc/1 directory to [TEST_PATH]/db-master/db/tablespace/ts1-2
  INFO: remap tablespace pg_tblspc/2 directory to [TEST_PATH]/db-master/db/tablespace/ts2-2
DETAIL: check [TEST_PATH]/db-master/db/base-2 exists
DETAIL: check [TEST_PATH]/db-master/db/tablespace/ts1-2 exists
DETAIL: check [TEST_PATH]/db-master/db/tablespace/ts2-2 exists
  INFO: restore file [TEST_PATH]/db-master/db/base-2/postgresql.conf (21B, 27%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
  INFO: restore file [TEST_PATH]/db-master/db/base-2/badchecksum.txt (11B, 42%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: restore file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 51%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
  INFO: restore file [TEST_PATH]/db-master/db/base-2/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt (7B, 60%) checksum d85de07d6421d90aa9191c11c889bfde43680f0f
  INFO: restore file [TEST_PATH]/db-master/db/base-2/pg_stat/global.stat (5B, 67%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/32768/33000 (5B, 73%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/16384/17000 (4B, 78%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/1/12000 (4B, 84%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/32768/PG_VERSION (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/16384/PG_VERSION (3B, 92%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/1/PG_VERSION (3B, 96%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base-2/PG_VERSION (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base-2/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base-2/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base-2/recovery.conf
------------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

restore delta, backup '[BACKUP-DIFF-2]', remap - ensure file in tblspc root remains after --delta (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --set=[BACKUP-DIFF-2] --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base-2 --delta --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --set=[BACKUP-DIFF-2] --stanza=db --tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2 --tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2
  INFO: restore backup set [BACKUP-DIFF-2]
  INFO: remap $PGDATA directory to [TEST_PATH]/db-master/db/base-2
  INFO: remap tablespace pg_tblspc/1 directory to [TEST_PATH]/db-master/db/tablespace/ts1-2
  INFO: remap tablespace pg_tblspc/2 directory to [TEST_PATH]/db-master/db/tablespace/ts2-2
DETAIL: check [TEST_PATH]/db-master/db/base-2 exists
DETAIL: check [TEST_PATH]/db-master/db/tablespace/ts1-2 exists
DETAIL: check [TEST_PATH]/db-master/db/tablespace/ts2-2 exists
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/tablespace/ts2-2/[TS_PATH-1]
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/tablespace/ts1-2/[TS_PATH-1]
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/base-2
DETAIL: preserve file [TEST_PATH]/db-master/db/base-2/recovery.conf
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/postgresql.conf - exists and matches backup (21B, 27%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/badchecksum.txt - exists and matches backup (11B, 42%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt - exists and matches backup (7B, 51%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/pg_tblspc/1/[TS_PATH-1]/16384/tablespace1.txt - exists and matches backup (7B, 60%) checksum d85de07d6421d90aa9191c11c889bfde43680f0f
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/pg_stat/global.stat - exists and matches backup (5B, 67%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/32768/33000 - exists and matches backup (5B, 73%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/16384/17000 - exists and matches backup (4B, 78%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/1/12000 - exists and matches backup (4B, 84%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/32768/PG_VERSION - exists and matches backup (3B, 88%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/16384/PG_VERSION - exists and matches backup (3B, 92%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/1/PG_VERSION - exists and matches backup (3B, 96%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/PG_VERSION - exists and matches backup (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base-2/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base-2/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base-2/recovery.conf
------------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

incr backup - add files and remove tablespace 2 (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-DIFF-2], version = [VERSION-1]
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2b.txt (8B, 61%) checksum e324463005236d83e6e54795dbddd20a74533bf3
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/base2.txt (5B, 100%) checksum 09b5e31766be1dba1ec27de82f975c1b6eea2a92
  INFO: incr backup size = 13B
  INFO: new backup label = [BACKUP-INCR-3]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-3]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-INCR-3]"
backup-prior="[BACKUP-DIFF-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="incr"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","reference":"[BACKUP-DIFF-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/base2.txt={"checksum":"09b5e31766be1dba1ec27de82f975c1b6eea2a92","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","reference":"[BACKUP-DIFF-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2b.txt={"checksum":"e324463005236d83e6e54795dbddd20a74533bf3","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-2]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

incr backup - update files (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast
  INFO: last backup label = [BACKUP-INCR-3], version = [VERSION-1]
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/16384/17000 (8B, 100%) checksum 9a53d532e27785e681766c98516a5e93f096a501
  INFO: incr backup size = 8B
  INFO: new backup label = [BACKUP-INCR-4]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-4]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-INCR-4]"
backup-prior="[BACKUP-INCR-3]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="incr"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","reference":"[BACKUP-DIFF-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"9a53d532e27785e681766c98516a5e93f096a501","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/base2.txt={"checksum":"09b5e31766be1dba1ec27de82f975c1b6eea2a92","reference":"[BACKUP-INCR-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","reference":"[BACKUP-DIFF-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2b.txt={"checksum":"e324463005236d83e6e54795dbddd20a74533bf3","reference":"[BACKUP-INCR-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-2]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-INCR-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]","[BACKUP-INCR-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

diff backup - updates since last full (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=diff --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --type=diff
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
  INFO: backup file [TEST_PATH]/db-master/db/base-2/badchecksum.txt (11B, 28%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2b.txt (8B, 48%) checksum e324463005236d83e6e54795dbddd20a74533bf3
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/16384/17000 (8B, 69%) checksum 9a53d532e27785e681766c98516a5e93f096a501
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 87%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/base2.txt (5B, 100%) checksum 09b5e31766be1dba1ec27de82f975c1b6eea2a92
  INFO: diff backup size = 39B
  INFO: new backup label = [BACKUP-DIFF-3]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-DIFF-3]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-DIFF-3]"
backup-prior="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="diff"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"9a53d532e27785e681766c98516a5e93f096a501","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/base2.txt={"checksum":"09b5e31766be1dba1ec27de82f975c1b6eea2a92","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2b.txt={"checksum":"e324463005236d83e6e54795dbddd20a74533bf3","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-2]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-INCR-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]","[BACKUP-INCR-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

incr backup - remove files - but won't affect manifest (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --stanza=db backup --test --test-delay=1 --test-point=manifest-build=y
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --test --test-delay=1 --test-point=manifest-build=y
  INFO: last backup label = [BACKUP-DIFF-3], version = [VERSION-1]
  INFO: incr backup size = 0B
  INFO: new backup label = [BACKUP-INCR-5]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-INCR-5]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-INCR-5]"
backup-prior="[BACKUP-DIFF-3]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="incr"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","reference":"[BACKUP-DIFF-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"9a53d532e27785e681766c98516a5e93f096a501","reference":"[BACKUP-DIFF-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/base2.txt={"checksum":"09b5e31766be1dba1ec27de82f975c1b6eea2a92","reference":"[BACKUP-DIFF-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","reference":"[BACKUP-DIFF-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2b.txt={"checksum":"e324463005236d83e6e54795dbddd20a74533bf3","reference":"[BACKUP-DIFF-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-2]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-INCR-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]","[BACKUP-INCR-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-5]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

diff backup - remove files during backup (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=diff --stanza=db backup --test --test-delay=1 --test-point=manifest-build=y
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --test --test-delay=1 --test-point=manifest-build=y --type=diff
  INFO: last backup label = [BACKUP-FULL-2], version = [VERSION-1]
  INFO: backup file [TEST_PATH]/db-master/db/base-2/badchecksum.txt (11B, 35%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt (12B, 61%) checksum dfcb8679956b734706cf87259d50c88f83e80e66
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 83%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
DETAIL: skip file removed by database: [TEST_PATH]/db-master/db/base-2/base/base2.txt
  INFO: diff backup size = 31B
  INFO: new backup label = [BACKUP-DIFF-4]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-DIFF-4]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-DIFF-4]"
backup-prior="[BACKUP-FULL-2]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="diff"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-2]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt={"checksum":"dfcb8679956b734706cf87259d50c88f83e80e66","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-2]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-INCR-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]","[BACKUP-INCR-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-5]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

full backup - update file (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=full --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --type=full
  INFO: backup file [TEST_PATH]/db-master/db/base-2/postgresql.conf (21B, 24%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt (12B, 38%) checksum dfcb8679956b734706cf87259d50c88f83e80e66
  INFO: backup file [TEST_PATH]/db-master/db/base-2/badchecksum.txt (11B, 51%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/16384/17000 (9B, 61%) checksum 7579ada0808d7f98087a0a586d0df9de009cdc33
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 69%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
  INFO: backup file [TEST_PATH]/db-master/db/base-2/pg_stat/global.stat (5B, 75%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/32768/33000 (5B, 81%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/1/12000 (4B, 86%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/32768/PG_VERSION (3B, 89%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/16384/PG_VERSION (3B, 93%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/1/PG_VERSION (3B, 96%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: backup file [TEST_PATH]/db-master/db/base-2/PG_VERSION (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: backup file [TEST_PATH]/db-master/db/base-2/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: full backup size = 8KB
  INFO: new backup label = [BACKUP-FULL-3]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-FULL-3]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-FULL-3]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="full"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"7579ada0808d7f98087a0a586d0df9de009cdc33","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt={"checksum":"dfcb8679956b734706cf87259d50c88f83e80e66","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-2]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-2]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-INCR-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-2]","[BACKUP-INCR-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-INCR-5]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-DIFF-3]","backup-reference":["[BACKUP-FULL-2]","[BACKUP-DIFF-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"incr","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-4]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-2]","backup-reference":["[BACKUP-FULL-2]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-FULL-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

info db stanza - normal output (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=warn --stanza=db info
------------------------------------------------------------------------------------------------------------------------------------
stanza: db
    status: ok

    full backup: [BACKUP-FULL-2]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 8KB
        repository size: 8KB, repository backup size: 8KB

    diff backup: [BACKUP-DIFF-2]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 25B
        repository size: 8KB, repository backup size: 25B
        backup reference list: [BACKUP-FULL-2]

    incr backup: [BACKUP-INCR-3]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 13B
        repository size: 8KB, repository backup size: 13B
        backup reference list: [BACKUP-FULL-2], [BACKUP-DIFF-2]

    incr backup: [BACKUP-INCR-4]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 8B
        repository size: 8KB, repository backup size: 8B
        backup reference list: [BACKUP-FULL-2], [BACKUP-DIFF-2], [BACKUP-INCR-3]

    diff backup: [BACKUP-DIFF-3]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 39B
        repository size: 8KB, repository backup size: 39B
        backup reference list: [BACKUP-FULL-2]

    incr backup: [BACKUP-INCR-5]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 0B
        repository size: 8KB, repository backup size: 0B
        backup reference list: [BACKUP-FULL-2], [BACKUP-DIFF-3]

    diff backup: [BACKUP-DIFF-4]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 30B
        repository size: 8KB, repository backup size: 30B
        backup reference list: [BACKUP-FULL-2]

    full backup: [BACKUP-FULL-3]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 8KB
        repository size: 8KB, repository backup size: 8KB

info db stanza - normal output (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --log-level-console=warn --stanza=db --output=json info
------------------------------------------------------------------------------------------------------------------------------------
[
    {
        "backup" : [
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-FULL-2]",
                "prior" : null,
                "reference" : null,
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "full"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-DIFF-2]",
                "prior" : "[BACKUP-FULL-2]",
                "reference" : [
                    "[BACKUP-FULL-2]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "diff"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-INCR-3]",
                "prior" : "[BACKUP-DIFF-2]",
                "reference" : [
                    "[BACKUP-FULL-2]",
                    "[BACKUP-DIFF-2]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "incr"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-INCR-4]",
                "prior" : "[BACKUP-INCR-3]",
                "reference" : [
                    "[BACKUP-FULL-2]",
                    "[BACKUP-DIFF-2]",
                    "[BACKUP-INCR-3]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "incr"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-DIFF-3]",
                "prior" : "[BACKUP-FULL-2]",
                "reference" : [
                    "[BACKUP-FULL-2]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "diff"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-INCR-5]",
                "prior" : "[BACKUP-DIFF-3]",
                "reference" : [
                    "[BACKUP-FULL-2]",
                    "[BACKUP-DIFF-3]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "incr"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-DIFF-4]",
                "prior" : "[BACKUP-FULL-2]",
                "reference" : [
                    "[BACKUP-FULL-2]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "diff"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-FULL-3]",
                "prior" : null,
                "reference" : null,
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "full"
            }
        ],
        "db" : [
            {
                "id" : "1",
                "system-id" : 6156904820763115222,
                "version" : "9.3"
            }
        ],
        "name" : "db",
        "status" : {
            "code" : 0,
            "message" : "ok"
        }
    }
]

expire full=1 (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --log-level-console=detail --retention-full=1  --stanza=db expire
------------------------------------------------------------------------------------------------------------------------------------
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --retention-full=1 --stanza=db
  INFO: expire full backup set: [BACKUP-FULL-2], [BACKUP-DIFF-2], [BACKUP-INCR-3], [BACKUP-INCR-4], [BACKUP-DIFF-3], [BACKUP-INCR-5], [BACKUP-DIFF-4]
  INFO: remove expired backup [BACKUP-DIFF-4]
  INFO: remove expired backup [BACKUP-INCR-5]
  INFO: remove expired backup [BACKUP-DIFF-3]
  INFO: remove expired backup [BACKUP-INCR-4]
  INFO: remove expired backup [BACKUP-INCR-3]
  INFO: remove expired backup [BACKUP-DIFF-2]
  INFO: remove expired backup [BACKUP-FULL-2]
  INFO: expire stop

diff backup - add file (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --no-online --log-level-console=detail --type=diff --stanza=db backup
------------------------------------------------------------------------------------------------------------------------------------
  INFO: backup start: --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --config-remote=[TEST_PATH]/db-master/pgbackrest.conf --db-host=db-master --db-path=[TEST_PATH]/db-master/db/base-2 --db-user=vagrant --hardlink --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --no-online --repo-path=[TEST_PATH]/backup/repo --stanza=db --start-fast --type=diff
  INFO: last backup label = [BACKUP-FULL-3], version = [VERSION-1]
  INFO: backup file [TEST_PATH]/db-master/db/base-2/base/base2.txt (9B, 100%) checksum cafac3c59553f2cfde41ce2e62e7662295f108c0
  INFO: diff backup size = 9B
  INFO: new backup label = [BACKUP-DIFF-5]
  INFO: backup stop
  INFO: expire start: --no-compress --config=[TEST_PATH]/backup/pgbackrest.conf --db-host=db-master --lock-path=[TEST_PATH]/backup/repo/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/backup/repo/log --repo-path=[TEST_PATH]/backup/repo --stanza=db
  INFO: archive retention type not set - archive logs will not be expired
  INFO: expire stop

+ supplemental file: [TEST_PATH]/db-master/pgbackrest.conf
----------------------------------------------------------
[db]
db-path=[TEST_PATH]/db-master/db/base-2

[db:restore]
tablespace-map=1=[TEST_PATH]/db-master/db/tablespace/ts1-2
tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2

[global]
backup-host=backup
backup-user=backrest
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/backup/pgbackrest.conf
lock-path=[TEST_PATH]/db-master/spool/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/db-master/spool/log
repo-path=[TEST_PATH]/backup/repo

+ supplemental file: [TEST_PATH]/backup/pgbackrest.conf
-------------------------------------------------------
[db]
db-host=db-master
db-path=[TEST_PATH]/db-master/db/base-2
db-user=[USER-1]

[global]
cmd-remote=[BACKREST-BIN]
compress=n
config-remote=[TEST_PATH]/db-master/pgbackrest.conf
lock-path=[TEST_PATH]/backup/repo/lock
log-level-console=debug
log-level-file=trace
log-path=[TEST_PATH]/backup/repo/log
repo-path=[TEST_PATH]/backup/repo

[global:backup]
archive-copy=y
hardlink=y
start-fast=y

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/[BACKUP-DIFF-5]/backup.manifest
--------------------------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup]
backup-label="[BACKUP-DIFF-5]"
backup-prior="[BACKUP-FULL-3]"
backup-timestamp-copy-start=[TIMESTAMP]
backup-timestamp-start=[TIMESTAMP]
backup-timestamp-stop=[TIMESTAMP]
backup-type="diff"

[backup:db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[backup:option]
option-archive-check=true
option-archive-copy=true
option-compress=false
option-hardlink=true
option-online=false

[backup:target]
pg_data={"path":"[TEST_PATH]/db-master/db/base-2","type":"path"}
pg_tblspc/2={"path":"[TEST_PATH]/db-master/db/tablespace/ts2-2","tablespace-id":"2","tablespace-name":"ts2","type":"link"}

[target:file]
pg_data/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/badchecksum.txt={"checksum":"f927212cd08d11a42a666b2f04235398e9ceeb51","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/12000={"checksum":"a3b357a3e395e43fcfb19bb13f3c1b5179279593","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/1/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","mode":"0660","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/17000={"checksum":"7579ada0808d7f98087a0a586d0df9de009cdc33","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/16384/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/33000={"checksum":"7f4c74dc10f61eef43e6ae642606627df1999b34","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/32768/PG_VERSION={"checksum":"e1f7a3a299f62225cba076fc6d3d6e677f303482","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/base/base2.txt={"checksum":"cafac3c59553f2cfde41ce2e62e7662295f108c0","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_data/global/pg_control={"checksum":"56fe5780b8dca9705e0c22032a83828860a21235","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/pg_stat/global.stat={"checksum":"e350d5ce0153f3e22d5db21cf2a4eff00f3ee877","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_data/postgresql.conf={"checksum":"6721d92c9fcdf4248acff1f9a1377127d9064807","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-2]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt={"checksum":"dc7f76e43c46101b47acc55ae4d593a9e6983578","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}
pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt={"checksum":"dfcb8679956b734706cf87259d50c88f83e80e66","reference":"[BACKUP-FULL-3]","size":[SIZE],"timestamp":[TIMESTAMP-1]}

[target:file:default]
group="postgres"
mode="0600"
user="vagrant"

[target:link]
pg_data/pg_tblspc/2={"destination":"[TEST_PATH]/db-master/db/tablespace/ts2-2"}

[target:link:default]
group="postgres"
user="vagrant"

[target:path]
pg_data={}
pg_data/base={}
pg_data/base/1={}
pg_data/base/16384={}
pg_data/base/32768={}
pg_data/global={}
pg_data/pg_clog={}
pg_data/pg_stat={}
pg_data/pg_tblspc={}
pg_tblspc={}
pg_tblspc/2={}
pg_tblspc/2/[TS_PATH-1]={}
pg_tblspc/2/[TS_PATH-1]/32768={}

[target:path:default]
group="postgres"
mode="0700"
user="vagrant"

+ supplemental file: [TEST_PATH]/backup/repo/backup/db/backup.info
------------------------------------------------------------------
[backrest]
backrest-checksum="[CHECKSUM]"
backrest-format=5
backrest-version="[VERSION-1]"

[backup:current]
[BACKUP-FULL-3]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"full","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}
[BACKUP-DIFF-5]={"backrest-format":5,"backrest-version":"[VERSION-1]","backup-archive-start":null,"backup-archive-stop":null,"backup-info-repo-size":[SIZE],"backup-info-repo-size-delta":[DELTA],"backup-info-size":[SIZE],"backup-info-size-delta":[DELTA],"backup-prior":"[BACKUP-FULL-3]","backup-reference":["[BACKUP-FULL-3]"],"backup-timestamp-start":[TIMESTAMP],"backup-timestamp-stop":[TIMESTAMP],"backup-type":"diff","db-id":1,"option-archive-check":true,"option-archive-copy":true,"option-compress":false,"option-hardlink":true,"option-online":false}

[db]
db-catalog-version=201306121
db-control-version=937
db-id=1
db-system-id=6156904820763115222
db-version="9.3"

[db:history]
1={"db-catalog-version":201306121,"db-control-version":937,"db-system-id":6156904820763115222,"db-version":"9.3"}

restore delta, remap - selective restore 16384 (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --log-level-console=detail --db-include=16384  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-include=16384=1 --db-path=[TEST_PATH]/db-master/db/base-2 --delta --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --stanza=db --tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2
  INFO: restore backup set [BACKUP-DIFF-5]
  INFO: remap tablespace pg_tblspc/2 directory to [TEST_PATH]/db-master/db/tablespace/ts2-2
DETAIL: check [TEST_PATH]/db-master/db/base-2 exists
DETAIL: check [TEST_PATH]/db-master/db/tablespace/ts2-2 exists
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/tablespace/ts2-2/[TS_PATH-1]
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/base-2
DETAIL: preserve file [TEST_PATH]/db-master/db/base-2/recovery.conf
DETAIL: databases for include/exclude (1, 16384, 32768)
DETAIL: database filter: (^pg_data\/base\/32768\/)|(^pg_tblspc/2\/[TS_PATH-1]\/32768\/)
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/postgresql.conf - exists and matches backup (21B, 22%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
DETAIL: restore zeroed file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt (12B, 34%)
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/badchecksum.txt - exists and matches backup (11B, 46%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/base2.txt - exists and matches backup (9B, 55%) checksum cafac3c59553f2cfde41ce2e62e7662295f108c0
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/16384/17000 - exists and matches backup (9B, 65%) checksum 7579ada0808d7f98087a0a586d0df9de009cdc33
DETAIL: restore zeroed file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 72%)
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/pg_stat/global.stat - exists and matches backup (5B, 77%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
DETAIL: restore zeroed file [TEST_PATH]/db-master/db/base-2/base/32768/33000 (5B, 83%)
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/1/12000 - exists and matches backup (4B, 87%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/32768/PG_VERSION - exists and matches backup (3B, 90%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/16384/PG_VERSION - exists and matches backup (3B, 93%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/1/PG_VERSION - exists and matches backup (3B, 96%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/PG_VERSION - exists and matches backup (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base-2/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base-2/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base-2/recovery.conf
------------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

restore delta, remap - selective restore 32768 (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --log-level-console=detail --db-include=32768  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-include=32768=1 --db-path=[TEST_PATH]/db-master/db/base-2 --delta --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --stanza=db --tablespace-map=2=[TEST_PATH]/db-master/db/tablespace/ts2-2
  INFO: restore backup set [BACKUP-DIFF-5]
  INFO: remap tablespace pg_tblspc/2 directory to [TEST_PATH]/db-master/db/tablespace/ts2-2
DETAIL: check [TEST_PATH]/db-master/db/base-2 exists
DETAIL: check [TEST_PATH]/db-master/db/tablespace/ts2-2 exists
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/tablespace/ts2-2/[TS_PATH-1]
  INFO: remove invalid files/paths/links from [TEST_PATH]/db-master/db/base-2
DETAIL: preserve file [TEST_PATH]/db-master/db/base-2/recovery.conf
DETAIL: databases for include/exclude (1, 16384, 32768)
DETAIL: database filter: (^pg_data\/base\/16384\/)|(^pg_tblspc/2\/[TS_PATH-1]\/16384\/)
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/postgresql.conf - exists and matches backup (21B, 22%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
  INFO: restore file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt (12B, 34%) checksum dfcb8679956b734706cf87259d50c88f83e80e66
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/badchecksum.txt - exists and matches backup (11B, 46%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/base2.txt - exists and matches backup (9B, 55%) checksum cafac3c59553f2cfde41ce2e62e7662295f108c0
DETAIL: restore zeroed file [TEST_PATH]/db-master/db/base-2/base/16384/17000 (9B, 65%)
  INFO: restore file [TEST_PATH]/db-master/db/base-2/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 72%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/pg_stat/global.stat - exists and matches backup (5B, 77%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/32768/33000 (5B, 83%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/1/12000 - exists and matches backup (4B, 87%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/32768/PG_VERSION - exists and matches backup (3B, 90%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/16384/PG_VERSION - exists and matches backup (3B, 93%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/base/1/PG_VERSION - exists and matches backup (3B, 96%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
DETAIL: restore file [TEST_PATH]/db-master/db/base-2/PG_VERSION - exists and matches backup (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base-2/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base-2/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base-2/recovery.conf
------------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

restore delta, remap, expect exit 155 - error on invalid id (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --log-level-console=warn --db-include=7777  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
 ERROR: [155]: database to include '7777' does not exist

restore delta, remap, expect exit 156 - error on system id (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --delta --log-level-console=warn --db-include=1  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
 ERROR: [156]: system databases (template0, postgres, etc.) are included by default

restore, remap, expect exit 148 - no tablespace remap - error when tablespace dir does not exist (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --tablespace-map-all=../../tablespace  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base-2/base --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --stanza=db --tablespace-map-all=../../tablespace
  INFO: restore backup set [BACKUP-DIFF-5]
  INFO: remap $PGDATA directory to [TEST_PATH]/db-master/db/base-2/base
  INFO: remap tablespace pg_tblspc/2 directory to ../../tablespace/ts2
DETAIL: check [TEST_PATH]/db-master/db/base-2/base exists
DETAIL: check [TEST_PATH]/db-master/db/base-2/tablespace exists
 ERROR: [148]: cannot restore to missing path [TEST_PATH]/db-master/db/base-2/tablespace
  INFO: restore stop

restore - no tablespace remap (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --tablespace-map-all=../../tablespace --log-level-console=detail  --stanza=db restore
------------------------------------------------------------------------------------------------------------------------------------
  INFO: restore start: --backup-host=backup --backup-user=backrest --cmd-remote=[BACKREST-BIN] --no-compress --config=[TEST_PATH]/db-master/pgbackrest.conf --config-remote=[TEST_PATH]/backup/pgbackrest.conf --db-path=[TEST_PATH]/db-master/db/base-2/base --lock-path=[TEST_PATH]/db-master/spool/lock --log-level-console=detail --log-level-file=trace --log-path=[TEST_PATH]/db-master/spool/log --repo-path=[TEST_PATH]/backup/repo --stanza=db --tablespace-map-all=../../tablespace
  INFO: restore backup set [BACKUP-DIFF-5]
  INFO: remap $PGDATA directory to [TEST_PATH]/db-master/db/base-2/base
  INFO: remap tablespace pg_tblspc/2 directory to ../../tablespace/ts2
DETAIL: check [TEST_PATH]/db-master/db/base-2/base exists
DETAIL: check [TEST_PATH]/db-master/db/base-2/tablespace exists
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/postgresql.conf (21B, 22%) checksum 6721d92c9fcdf4248acff1f9a1377127d9064807
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2c.txt (12B, 34%) checksum dfcb8679956b734706cf87259d50c88f83e80e66
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/badchecksum.txt (11B, 46%) checksum f927212cd08d11a42a666b2f04235398e9ceeb51
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/base2.txt (9B, 55%) checksum cafac3c59553f2cfde41ce2e62e7662295f108c0
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/16384/17000 (9B, 65%) checksum 7579ada0808d7f98087a0a586d0df9de009cdc33
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/pg_tblspc/2/[TS_PATH-1]/32768/tablespace2.txt (7B, 72%) checksum dc7f76e43c46101b47acc55ae4d593a9e6983578
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/pg_stat/global.stat (5B, 77%) checksum e350d5ce0153f3e22d5db21cf2a4eff00f3ee877
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/32768/33000 (5B, 83%) checksum 7f4c74dc10f61eef43e6ae642606627df1999b34
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/1/12000 (4B, 87%) checksum a3b357a3e395e43fcfb19bb13f3c1b5179279593
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/32768/PG_VERSION (3B, 90%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/16384/PG_VERSION (3B, 93%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/base/1/PG_VERSION (3B, 96%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/PG_VERSION (3B, 100%) checksum e1f7a3a299f62225cba076fc6d3d6e677f303482
  INFO: wrote [TEST_PATH]/db-master/db/base-2/base/recovery.conf
  INFO: restore global/pg_control (copied last to ensure aborted restores cannot be started)
  INFO: restore file [TEST_PATH]/db-master/db/base-2/base/global/pg_control (8KB) checksum 56fe5780b8dca9705e0c22032a83828860a21235
  INFO: restore stop

+ supplemental file: [TEST_PATH]/db-master/db/base-2/base/recovery.conf
-----------------------------------------------------------------------
restore_command = '[BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=detail --stanza=db archive-get %f "%p"'

info all stanzas - normal output (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --log-level-console=warn info
------------------------------------------------------------------------------------------------------------------------------------
stanza: db
    status: ok

    full backup: [BACKUP-FULL-3]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 8KB
        repository size: 8KB, repository backup size: 8KB

    diff backup: [BACKUP-DIFF-5]
        start / stop timestamp: [TIMESTAMP-STR]
        database size: 8KB, backup size: 9B
        repository size: 8KB, repository backup size: 9B
        backup reference list: [BACKUP-FULL-3]

stanza: db_empty
    status: error (no valid backups)

info all stanzas - normal output (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=warn --output=json info
------------------------------------------------------------------------------------------------------------------------------------
[
    {
        "backup" : [
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-FULL-3]",
                "prior" : null,
                "reference" : null,
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "full"
            },
            {
                "archive" : {
                    "start" : null,
                    "stop" : null
                },
                "backrest" : {
                    "format" : 5,
                    "version" : "[VERSION-1]"
                },
                "database" : {
                    "id" : 1
                },
                "info" : {
                    "delta" : [DELTA],
                    "repository" : {
                        "delta" : [DELTA],
                        "size" : [SIZE]
                    },
                    "size" : [SIZE]
                },
                "label" : "[BACKUP-DIFF-5]",
                "prior" : "[BACKUP-FULL-3]",
                "reference" : [
                    "[BACKUP-FULL-3]"
                ],
                "timestamp" : {
                    "start" : [TIMESTAMP],
                    "stop" : [TIMESTAMP]
                },
                "type" : "diff"
            }
        ],
        "db" : [
            {
                "id" : "1",
                "system-id" : 6156904820763115222,
                "version" : "9.3"
            }
        ],
        "name" : "db",
        "status" : {
            "code" : 0,
            "message" : "ok"
        }
    },
    {
        "backup" : [],
        "db" : [],
        "name" : "db_empty",
        "status" : {
            "code" : 2,
            "message" : "no valid backups"
        }
    }
]

info bogus stanza - bogus stanza (backup host)
> [CONTAINER-EXEC] backup [BACKREST-BIN] --config=[TEST_PATH]/backup/pgbackrest.conf --log-level-console=warn --stanza=bogus info
------------------------------------------------------------------------------------------------------------------------------------
stanza: bogus
    status: error (missing stanza path)

info bogus stanza - bogus stanza (db-master host)
> [CONTAINER-EXEC] db-master [BACKREST-BIN] --config=[TEST_PATH]/db-master/pgbackrest.conf --log-level-console=warn --stanza=bogus --output=json info
------------------------------------------------------------------------------------------------------------------------------------
[
    {
        "backup" : [],
        "db" : [],
        "name" : "bogus",
        "status" : {
            "code" : 1,
            "message" : "missing stanza path"
        }
    }
]
